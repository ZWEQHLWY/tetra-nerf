import pytest

t0 = [
    (0.972510457039, 6037, 3),
    (0.972569048405, 6037, 0),
    (0.972569108009, 6041, 1),
    (0.972576022148, 6041, 2),
    (0.972576141357, 6043, 0),
    (0.972595214844, 5944, 3),
    (0.972595214844, 6043, 2),
    (0.972879409790, 6086, 0),
    (0.972879409790, 5944, 0),
    (0.973426520824, 5977, 0),
    (0.973426580429, 6086, 3),
    (0.974273860455, 5977, 3),
    (0.974273860455, 5920, 0),
    (0.975232958794, 5896, 0),
    (0.975233018398, 5920, 2),
    (0.975487470627, 4111, 1),
    (0.975487530231, 5896, 3),
    (0.977408945560, 4111, 0),
    (0.977409005165, 5979, 1),
    (0.980458378792, 5979, 0),
    (0.980458378792, 4328, 3),
    (0.983064293861, 465, 1),
    (0.983064293861, 4328, 0),
    (0.983373045921, 6063, 1),
    (0.983373165131, 465, 2),
    (0.984811961651, 6063, 2),
    (0.984811961651, 5448, 0),
    (0.984867751598, 6030, 2),
    (0.984867751598, 5448, 3),
    (0.985055446625, 6030, 1),
    (0.985055506229, 5577, 1),
    (0.985147476196, 701, 0),
    (0.985147595406, 5577, 2),
    (0.985499560833, 701, 3),
    (0.985499560833, 5674, 0),
    (0.985586941242, 5674, 1),
    (0.985586941242, 5690, 2),
    (0.985710501671, 1199, 2),
    (0.985710501671, 5690, 1),
    (0.985710501671, 5726, 3),
    (0.985710501671, 1199, 3),
    (0.985769450665, 5660, 0),
    (0.985769510269, 5452, 1),
    (0.985769510269, 5726, 2),
    (0.985769510269, 5660, 3),
    (0.985903143883, 5452, 0),
    (0.985903263092, 1091, 3),
    (0.986066639423, 4631, 0),
    (0.986066639423, 1091, 0),
    (0.986095607281, 5728, 0),
    (0.986095666885, 4631, 1),
    (0.986498177052, 5095, 2),
    (0.986498355865, 5728, 1),
    (0.987716555595, 5095, 1),
    (0.987716555595, 5698, 0),
    (0.988098621368, 5403, 0),
    (0.988098740578, 5698, 3),
    (0.988833546638, 3995, 2),
    (0.988833606243, 4952, 2),
    (0.988833606243, 5403, 3),
    (0.988833606243, 3995, 0),
    (0.989562988281, 579, 0),
    (0.989563047886, 4952, 1),
    (0.990156888962, 579, 1),
    (0.990156948566, 4995, 2),
    (0.990264236927, 549, 1),
    (0.990264356136, 4995, 1),
    (0.990368068218, 4983, 0),
    (0.990368068218, 549, 2),
    (0.990392982960, 4950, 0),
    (0.990392982960, 4983, 2),
    (0.990418672562, 4950, 1),
    (0.990418732166, 5110, 1),
    (0.990433394909, 5112, 1),
    (0.990433394909, 5110, 2),
    (0.990465760231, 5112, 2),
    (0.990465760231, 5111, 2),
    (0.990573942661, 5113, 1),
    (0.990573942661, 5111, 1),
    (0.990574002266, 5113, 2),
    (0.990574002266, 56, 3),
    (0.991183578968, 56, 0),
    (0.991183578968, 4112, 3),
    (0.991295635700, 4112, 0),
    (0.991295635700, 5077, 2),
    (0.991808533669, 5077, 1),
    (0.991808533669, 5001, 2),
    (0.992106795311, 5334, 3),
    (0.992106854916, 5001, 1),
    (0.992242395878, 5334, 2),
    (0.992242395878, 5326, 0),
    (0.992658734322, 3685, 0),
    (0.992658734322, 5326, 3),
    (0.993491947651, 3685, 2),
    (0.993492066860, 4144, 2),
    (0.994044065475, 5060, 1),
    (0.994044184685, 4144, 3),
    (1.000591158867, 5060, 0),
    (1.000591158867, 4940, 0),
    (1.000591158867, 4940, 0),
    (1.000591158867, 5060, 0),
    (1.002973794937, 4326, 1),
    (1.002973794937, 4940, 3),
    (1.002973794937, 4326, 1),
    (1.002973794937, 4940, 3),
    (1.013779282570, 4326, 2),
    (1.013779282570, 4326, 2),
    (1.013779282570, 4344, 0),
    (1.013779282570, 4344, 0),
    (1.016240239143, 4344, 2),
    (1.016240239143, 4464, 3),
    (1.016529679298, 4455, 0),
    (1.016529679298, 4464, 2),
    (1.016740202904, 4455, 3),
    (1.016740322113, 4448, 0),
    (1.017095565796, 4327, 1),
    (1.017095565796, 4448, 3),
    (1.017521142960, 4200, 2),
    (1.017521142960, 4327, 0),
    (1.017544984818, 4338, 0),
    (1.017545104027, 3470, 3),
    (1.017545104027, 4200, 3),
    (1.017545223236, 4338, 1),
    (1.018163800240, 3470, 2),
    (1.018163800240, 4378, 1),
    (1.018744111061, 4378, 3),
    (1.018744111061, 4337, 2),
    (1.020662188530, 4316, 1),
    (1.020662188530, 4337, 1),
    (1.020850539207, 4316, 3),
    (1.020850539207, 4276, 1),
    (1.021742939949, 4295, 3),
    (1.021742939949, 4276, 2),
    (1.022720813751, 4273, 2),
    (1.022720813751, 4295, 1),
    (1.024700999260, 4274, 2),
    (1.024700999260, 4273, 0),
    (1.025426745415, 4274, 1),
    (1.025426745415, 3893, 1),
    (1.026882648468, 3893, 2),
    (1.026882767677, 4308, 1),
    (1.028700232506, 3849, 0),
    (1.028700232506, 4308, 3),
    (1.030276536942, 3849, 3),
    (1.030276536942, 3920, 2),
    (1.031075954437, 3920, 0),
    (1.031075954437, 3918, 2),
    (1.031375527382, 3918, 0),
    (1.031375646591, 3865, 2),
    (1.032112240791, 3865, 1),
    (1.032112360001, 3867, 2),
    (1.032456994057, 3867, 0),
    (1.032457113266, 3916, 2),
    (1.032845616341, 3916, 1),
    (1.032845616341, 3911, 1),
    (1.033116817474, 3911, 2),
    (1.033116936684, 3904, 0),
    (1.033315539360, 3900, 1),
    (1.033315539360, 3904, 2),
    (1.033468961716, 3901, 0),
    (1.033468961716, 3900, 2),
    (1.033558607101, 3903, 1),
    (1.033558607101, 3901, 2),
    (1.033589601517, 388, 3),
    (1.033589601517, 3903, 3),
    (1.033622264862, 385, 1),
    (1.033622384071, 388, 2),
    (1.033639788628, 385, 2),
]

t1 = [
    (0.958806693554, 7974, 0),
    (0.958806753159, 8089, 3),
    (0.958806753159, 8089, 2),
    (0.959681212902, 7974, 3),
    (0.959681212902, 8338, 3),
    (0.960293591022, 8338, 2),
    (0.960293650627, 8339, 0),
    (0.961785435677, 7758, 0),
    (0.961785495281, 8339, 3),
    (0.961813628674, 7758, 2),
    (0.961813628674, 8041, 2),
    (0.961820542812, 8041, 1),
    (0.961820721626, 8345, 3),
    (0.963012874126, 8345, 1),
    (0.963012933731, 8343, 0),
    (0.966500043869, 8343, 3),
]

t2 = [
    (0.993463277817, 6622, 3),
    (0.993463397026, 6621, 2),
    (0.993463456631, 6622, 2),
    (0.998577117920, 6621, 1),
    (0.998577117920, 6435, 3),
    (1.000015020370, 6487, 0),
    (1.000015020370, 6682, 2),
    (1.000015139580, 6435, 1),
    (1.000015139580, 6682, 1),
    (1.000601172447, 6617, 2),
    (1.000601172447, 6487, 1),
    (1.006613612175, 6664, 3),
    (1.006613612175, 6617, 1),
    (1.007559895515, 6664, 1),
    (1.007559895515, 6637, 2),
    (1.008991837502, 6676, 1),
    (1.008991837502, 6637, 1),
    (1.010245442390, 6678, 0),
    (1.010245442390, 6676, 0),
    (1.011040210724, 1789, 2),
    (1.011040210724, 6678, 3),
    (1.016818284988, 1789, 3),
    (1.016818284988, 6702, 3),
    (1.017428398132, 6702, 1),
    (1.017428398132, 6680, 1),
    (1.017524361610, 763, 0),
    (1.017524361610, 6680, 3),
    (1.017718672752, 763, 1),
    (1.017718672752, 1850, 3),
    (1.018247008324, 1850, 0),
    (1.018247127533, 1851, 2),
    (1.018908619881, 749, 2),
    (1.018908619881, 1851, 3),
    (1.018908858299, 749, 0),
]

t3 = [
    (0.953970849514, 7503, 1),
    (0.954373121262, 7503, 3),
    (0.954373121262, 7562, 3),
    (0.956100642681, 7869, 3),
    (0.956100702286, 7562, 1),
    (0.958509147167, 7430, 1),
    (0.958509147167, 7926, 0),
    (0.958509206772, 7869, 0),
    (0.958509206772, 7926, 1),
    (0.959618985653, 7156, 1),
    (0.959618985653, 7430, 2),
    (0.960294663906, 7156, 0),
    (0.960294723511, 8102, 3),
    (0.961792826653, 8102, 0),
    (0.961792826653, 8099, 2),
    (0.968112289906, 8099, 3),
    (0.968112349510, 8029, 1),
    (0.970751404762, 8029, 0),
    (0.970751583576, 8031, 1),
    (0.975778937340, 8043, 3),
    (0.975778937340, 8034, 0),
    (0.975779056549, 8031, 2),
    (0.975779056549, 8031, 2),
    (0.975779116154, 8034, 1),
    (0.975779116154, 8034, 1),
    (0.980487704277, 8044, 1),
    (0.980487704277, 8044, 1),
    (0.980487704277, 8043, 0),
    (0.980487704277, 8043, 0),
    (0.983322560787, 7836, 0),
    (0.983322560787, 8044, 0),
    (0.983865320683, 7836, 1),
    (0.983865320683, 8125, 3),
    (0.983915627003, 8125, 2),
    (0.983915627003, 13442, 3),
    (0.986142873764, 13440, 2),
    (0.986142933369, 13442, 0),
    (0.989207267761, 13440, 3),
    (0.989207267761, 13248, 1),
    (0.990204811096, 13248, 0),
    (0.990204811096, 13246, 0),
    (0.990383744240, 13463, 3),
    (0.990383863449, 13246, 1),
    (0.991062998772, 13463, 1),
    (0.991063058376, 923, 3),
    (0.991209983826, 13183, 1),
    (0.991209983826, 923, 2),
    (0.996248900890, 13183, 0),
]

t4 = [
    (0.951950132847, 7687, 2),
    (0.952007591724, 7687, 3),
    (0.952007591724, 7676, 2),
    (0.952026724815, 7674, 0),
    (0.952026724815, 7676, 0),
    (0.952346980572, 7674, 2),
    (0.952346980572, 7675, 1),
    (0.952514290810, 7675, 2),
    (0.952514290810, 6224, 1),
    (0.952668130398, 6224, 2),
    (0.952668190002, 7601, 1),
    (0.953020036221, 7601, 3),
    (0.953020036221, 7390, 2),
    (0.955229163170, 7390, 3),
    (0.955229222775, 7572, 0),
    (0.955947577953, 670, 3),
    (0.955947577953, 7572, 1),
    (0.956061959267, 6268, 3),
    (0.956061959267, 670, 2),
    (0.956127226353, 6268, 0),
    (0.956127226353, 6014, 1),
    (0.956517875195, 7119, 2),
    (0.956517934799, 6014, 2),
    (0.957705855370, 7440, 0),
    (0.957705855370, 7119, 3),
    (0.957720994949, 7512, 0),
    (0.957720994949, 7440, 1),
    (0.957774162292, 7512, 1),
    (0.957774162292, 7868, 3),
    (0.957862079144, 7868, 2),
    (0.957862079144, 8011, 1),
    (0.957862734795, 8011, 3),
    (0.957862734795, 7496, 1),
    (0.958042442799, 7496, 3),
    (0.958042442799, 1573, 3),
    (0.961282312870, 8042, 0),
    (0.961282312870, 1573, 1),
    (0.961537718773, 711, 0),
    (0.961537718773, 8042, 3),
    (0.961865246296, 711, 3),
    (0.961865246296, 7009, 1),
    (0.962105035782, 7008, 2),
    (0.962105035782, 7009, 0),
    (0.962255477905, 7007, 2),
    (0.962255477905, 7008, 0),
    (0.962283253670, 7007, 0),
    (0.962283253670, 7006, 0),
    (0.962322413921, 7006, 1),
    (0.962322413921, 5939, 3),
    (0.962602794170, 5939, 0),
    (0.962602794170, 957, 0),
    (0.962744772434, 957, 3),
    (0.962744772434, 769, 2),
    (0.962816596031, 751, 1),
    (0.962816596031, 769, 1),
    (0.963247001171, 751, 3),
    (0.963247001171, 6174, 3),
    (0.963257849216, 6999, 0),
    (0.963257849216, 6174, 1),
    (0.963288187981, 7157, 0),
    (0.963288307190, 6999, 3),
    (0.963337898254, 7016, 3),
    (0.963337898254, 7157, 3),
    (0.963405489922, 5814, 3),
    (0.963405489922, 7016, 1),
    (0.963489234447, 5814, 2),
    (0.963489234447, 2886, 1),
    (0.963669657707, 2886, 2),
    (0.963669657707, 2886, 2),
    (0.963669717312, 6844, 0),
    (0.963669717312, 6844, 0),
    (0.963794827461, 734, 0),
    (0.963794827461, 734, 0),
    (0.963794887066, 6844, 3),
    (0.963794887066, 6844, 3),
    (0.963968038559, 6978, 1),
    (0.963968038559, 6978, 1),
    (0.963968217373, 734, 3),
    (0.963968217373, 734, 3),
    (0.964185237885, 6978, 2),
    (0.964185237885, 6912, 0),
    (0.964185237885, 6912, 0),
    (0.964185237885, 6978, 2),
    (0.964441359043, 6976, 0),
    (0.964441359043, 6912, 1),
    (0.964441359043, 6912, 1),
    (0.964441359043, 6976, 0),
    (0.964730620384, 6976, 1),
    (0.964730620384, 6958, 1),
    (0.964730620384, 6976, 1),
    (0.964730620384, 6958, 1),
    (0.965046346188, 6971, 1),
    (0.965046346188, 6958, 2),
    (0.965046346188, 6971, 1),
    (0.965046346188, 6958, 2),
    (0.965380847454, 6973, 0),
    (0.965380847454, 6973, 0),
    (0.965380847454, 6971, 2),
    (0.965380847454, 6971, 2),
    (0.965726375580, 6973, 1),
    (0.965726375580, 6970, 1),
    (0.965726375580, 6973, 1),
    (0.965726375580, 6970, 1),
    (0.966074287891, 6964, 1),
    (0.966074287891, 6964, 1),
    (0.966074347496, 6970, 2),
    (0.966074347496, 6970, 2),
    (0.966415941715, 6964, 2),
    (0.966415941715, 6964, 2),
    (0.966415941715, 13174, 3),
    (0.966415941715, 13174, 3),
    (0.966743052006, 6511, 3),
    (0.966743052006, 13174, 2),
    (0.966743052006, 13174, 2),
    (0.966743052006, 6511, 3),
    (0.967047095299, 6511, 0),
    (0.967047095299, 6511, 0),
    (0.967047274113, 7259, 2),
    (0.967047274113, 7259, 2),
    (1.026660323143, 7259, 1),
    (1.026660323143, 7260, 2),
    (1.026660323143, 7259, 1),
    (1.026660323143, 7260, 2),
    (1.026724696159, 7260, 3),
    (1.026724696159, 13175, 1),
    (1.026724696159, 7260, 3),
    (1.026724696159, 13175, 1),
    (1.026771545410, 13175, 3),
    (1.026771545410, 13175, 3),
    (1.026771545410, 12114, 2),
    (1.026771545410, 12114, 2),
    (1.026799440384, 12114, 0),
    (1.026799440384, 10951, 0),
    (1.026799440384, 10951, 0),
    (1.026799440384, 12114, 0),
    (1.036239743233, 10951, 3),
    (1.036239743233, 3053, 1),
    (1.036239743233, 10951, 3),
    (1.036239743233, 3053, 1),
    (1.036332249641, 3053, 0),
    (1.036332249641, 3049, 0),
    (1.036332249641, 3053, 0),
    (1.036332249641, 3049, 0),
    (1.036400556564, 3049, 2),
    (1.036400556564, 3051, 1),
    (1.036400556564, 3049, 2),
    (1.036400556564, 3051, 1),
    (1.036442995071, 3051, 0),
    (1.036442995071, 3059, 1),
    (1.036442995071, 3059, 1),
    (1.036442995071, 3051, 0),
    (1.036458373070, 3069, 0),
    (1.036458373070, 3059, 0),
    (1.036458373070, 3059, 0),
    (1.036458373070, 3069, 0),
    (1.038254976273, 1754, 0),
    (1.038254976273, 1754, 0),
    (1.038255095482, 3069, 2),
    (1.038255095482, 3069, 2),
    (1.044895052910, 1754, 3),
    (1.044895052910, 1549, 0),
    (1.045070290565, 1549, 2),
    (1.045070409775, 2331, 1),
    (1.045216083527, 2690, 0),
    (1.045216202736, 2331, 0),
    (1.045333743095, 2643, 1),
    (1.045333743095, 2690, 2),
    (1.045426368713, 2643, 0),
    (1.045426368713, 1959, 0),
    (1.045497655869, 2645, 0),
    (1.045497655869, 1959, 2),
    (1.046321630478, 2647, 2),
    (1.046321630478, 2645, 2),
    (1.047078967094, 2647, 0),
    (1.047079086304, 2649, 2),
    (1.047090768814, 2650, 2),
    (1.047090768814, 2649, 1),
    (1.047105073929, 2660, 0),
    (1.047105073929, 2650, 1),
    (1.047324776649, 223, 0),
    (1.047324776649, 2660, 3),
    (1.047332763672, 223, 2),
    (1.047332882881, 2185, 1),
    (1.047358989716, 2079, 1),
    (1.047358989716, 2185, 0),
    (1.047405123711, 2535, 3),
    (1.047405123711, 2079, 0),
    (1.048095703125, 2535, 0),
    (1.048095822334, 1920, 2),
    (1.050573110580, 1920, 0),
    (1.050573110580, 2374, 2),
    (1.050573229790, 2374, 1),
    (1.050573229790, 2293, 1),
    (1.050771117210, 2306, 3),
    (1.050771117210, 2293, 0),
    (1.051271557808, 2372, 0),
    (1.051271677017, 2306, 2),
    (1.051513075829, 2372, 2),
    (1.051513075829, 2573, 2),
    (1.051543593407, 2573, 1),
    (1.051543593407, 2320, 2),
]

t5 = [
    (0.955193281174, 7005, 0),
    (0.955193281174, 7605, 0),
    (0.955193281174, 7005, 1),
    (0.955203235149, 7609, 0),
    (0.955203354359, 7605, 1),
    (0.955240249634, 7245, 3),
    (0.955240309238, 7609, 3),
    (0.955240309238, 7613, 2),
    (0.955240428448, 7613, 1),
    (0.955836832523, 6025, 0),
    (0.955836832523, 7245, 2),
    (0.956045031548, 7375, 2),
    (0.956045031548, 6025, 1),
    (0.956219613552, 7458, 1),
    (0.956219613552, 7375, 1),
    (0.956440985203, 7416, 0),
    (0.956440985203, 7458, 0),
    (0.956492245197, 7416, 1),
    (0.956492245197, 7459, 2),
    (0.957094550133, 7461, 2),
    (0.957094550133, 7459, 0),
    (0.959230720997, 7461, 3),
    (0.959230720997, 6342, 2),
    (0.960898816586, 6342, 1),
    (0.960898816586, 865, 3),
    (0.960898816586, 6342, 1),
    (0.960898816586, 865, 3),
    (0.961601734161, 865, 1),
    (0.961601734161, 6990, 1),
    (0.961601734161, 6990, 1),
    (0.961601734161, 865, 1),
    (0.961867809296, 6990, 2),
    (0.961867809296, 7047, 1),
    (0.961867809296, 6990, 2),
    (0.961867809296, 7047, 1),
    (0.962988793850, 7047, 0),
    (0.962988793850, 7047, 0),
    (0.962988972664, 6994, 1),
    (0.962988972664, 6994, 1),
    (0.963010787964, 6994, 3),
    (0.963010787964, 6994, 3),
    (0.963010847569, 7004, 3),
    (0.963010847569, 7004, 3),
    (0.963603615761, 7004, 0),
    (0.963603615761, 6658, 2),
    (0.963603615761, 7004, 0),
    (0.963603615761, 6658, 2),
    (0.971532166004, 751, 0),
    (0.971532166004, 6658, 0),
    (0.971532166004, 6658, 0),
    (0.971532166004, 751, 0),
    (0.973566293716, 751, 3),
    (0.973566293716, 751, 3),
    (0.973566412926, 6174, 3),
    (0.973566412926, 6174, 3),
    (0.973583281040, 6174, 1),
    (0.973583281040, 6999, 0),
    (0.973583281040, 6174, 1),
    (0.973583281040, 6999, 0),
    (0.973631501198, 6999, 3),
    (0.973631501198, 6999, 3),
    (0.973631560802, 7157, 0),
    (0.973631560802, 7157, 0),
    (0.973710060120, 7016, 3),
    (0.973710060120, 7157, 3),
    (0.973710060120, 7016, 3),
    (0.973710060120, 7157, 3),
    (0.973816692829, 7016, 1),
    (0.973816692829, 5814, 3),
    (0.973816692829, 5814, 3),
    (0.973816692829, 7016, 1),
    (0.973949313164, 2886, 1),
    (0.973949313164, 5814, 2),
    (0.973949313164, 5814, 2),
    (0.973949313164, 5814, 2),
    (0.973949313164, 2886, 1),
    (0.973949313164, 2886, 1),
    (0.994261384010, 2886, 2),
    (0.994261384010, 6844, 0),
    (0.994261384010, 2886, 2),
    (0.994261384010, 6844, 0),
    (0.994261384010, 6844, 0),
    (0.994261384010, 2886, 2),
    (0.994484245777, 6844, 3),
    (0.994484245777, 734, 0),
    (0.994484245777, 734, 0),
    (0.994484245777, 6844, 3),
    (0.994484245777, 734, 0),
    (0.994484245777, 6844, 3),
    (0.994792401791, 6978, 1),
    (0.994792401791, 734, 3),
    (0.994792401791, 734, 3),
    (0.994792401791, 6978, 1),
    (0.994792401791, 6978, 1),
    (0.994792401791, 734, 3),
    (0.995178937912, 6978, 2),
    (0.995178937912, 6912, 0),
    (0.995178937912, 6912, 0),
    (0.995178937912, 6978, 2),
    (0.995178937912, 6978, 2),
    (0.995178937912, 6912, 0),
    (0.995635032654, 6912, 1),
    (0.995635032654, 6912, 1),
    (0.995635032654, 6912, 1),
    (0.995635032654, 6976, 0),
    (0.995635032654, 6976, 0),
    (0.995635032654, 6976, 0),
    (0.996150314808, 6976, 1),
    (0.996150314808, 6976, 1),
    (0.996150314808, 6976, 1),
    (0.996150374413, 6958, 1),
    (0.996150374413, 6958, 1),
    (0.996150374413, 6958, 1),
    (0.996713042259, 6958, 2),
    (0.996713042259, 6958, 2),
    (0.996713042259, 6958, 2),
    (0.996713161469, 6971, 1),
    (0.996713161469, 6971, 1),
    (0.996713161469, 6971, 1),
    (0.997309684753, 6973, 0),
    (0.997309684753, 6971, 2),
    (0.997309684753, 6973, 0),
    (0.997309684753, 6973, 0),
    (0.997309684753, 6971, 2),
    (0.997309684753, 6971, 2),
    (0.997925937176, 6970, 1),
    (0.997925937176, 6973, 1),
    (0.997925937176, 6973, 1),
    (0.997925937176, 6970, 1),
    (0.997925937176, 6973, 1),
    (0.997925937176, 6970, 1),
    (0.998546898365, 6970, 2),
    (0.998546898365, 6970, 2),
    (0.998546898365, 6970, 2),
    (0.998547077179, 6964, 1),
    (0.998547077179, 6964, 1),
    (0.998547077179, 6964, 1),
    (0.999157369137, 13174, 3),
    (0.999157369137, 6964, 2),
    (0.999157369137, 13174, 3),
    (0.999157369137, 6964, 2),
    (0.999157369137, 13174, 3),
    (0.999157369137, 6964, 2),
    (0.999741733074, 13174, 2),
    (0.999741733074, 6511, 3),
    (0.999741733074, 13174, 2),
    (0.999741733074, 6511, 3),
    (0.999741733074, 13174, 2),
    (0.999741733074, 6511, 3),
    (1.000285267830, 6511, 0),
    (1.000285267830, 7259, 2),
    (1.000285267830, 6511, 0),
    (1.000285267830, 7259, 2),
    (1.000285267830, 6511, 0),
    (1.000285267830, 7259, 2),
    (1.023416042328, 7259, 1),
    (1.023416042328, 7260, 2),
    (1.023501515388, 7260, 3),
    (1.023501515388, 13175, 1),
    (1.023563385010, 12114, 2),
    (1.023563385010, 13175, 3),
    (1.023599982262, 12114, 0),
    (1.023599982262, 10951, 0),
    (1.027335643768, 10951, 3),
    (1.027335643768, 3053, 1),
    (1.027453422546, 3049, 0),
    (1.027453422546, 3053, 0),
    (1.027540445328, 3049, 2),
    (1.027540445328, 3051, 1),
    (1.027594208717, 3059, 1),
    (1.027594208717, 3051, 0),
    (1.027613759041, 3059, 0),
    (1.027613759041, 3069, 0),
    (1.029899597168, 3069, 2),
    (1.029899597168, 1754, 0),
    (1.040679216385, 1754, 2),
    (1.040679335594, 1757, 0),
    (1.040956258774, 3013, 1),
    (1.040956258774, 1757, 1),
    (1.041186451912, 3013, 0),
    (1.041186451912, 3009, 3),
    (1.041509509087, 3009, 0),
    (1.041509509087, 3012, 0),
    (1.042119026184, 3012, 2),
    (1.042119026184, 2622, 1),
    (1.045120477676, 2622, 3),
    (1.045120477676, 1631, 2),
    (1.047206997871, 2205, 3),
    (1.047206997871, 1631, 1),
    (1.047207474709, 2205, 2),
    (1.047207474709, 2147, 3),
    (1.048082232475, 2147, 1),
    (1.048082232475, 2363, 2),
    (1.048091292381, 2473, 2),
    (1.048091411591, 2363, 1),
    (1.048489928246, 2702, 1),
    (1.048489928246, 2702, 2),
    (1.048489928246, 2473, 0),
    (1.048490047455, 2701, 0),
    (1.048493862152, 2700, 1),
    (1.048513174057, 2700, 0),
]


@pytest.mark.parametrize("t", [t0, t1, t2, t3, t4])
def test_sort(t):
    print()
    o = []
    ray_len = len(t)

    # Dedupe duplicated triangles
    j = 0
    while j < len(t) - 1:
        offset = 1
        if t[j] is None:
            j += 1
            continue
        dn = t[j][0]
        clear_self = False
        while j + offset < ray_len and (t[j + offset] is None or abs(t[j + offset][0] - dn) < 1e-6):
            if t[j + offset] is not None and t[j][1] == t[j + offset][1]:
                if t[j][2] != t[j + offset][2]:
                    # zero-size traversal (different faces)
                    # We ignore those
                    clear_self = True
                t[j + offset] = None
            offset += 1
        if clear_self:
            t[j] = None
        j += 1

    j = 0
    has_error = False
    while j < len(t):
        if t[j] is None:
            j += 1
            continue
        d, f, f2 = t[j]
        offset = 1
        dn = d

        real_offset = 1
        while j + offset < len(t) and (real_offset < 3 or t[j + offset] is None or abs(t[j + offset][0] - dn) < 1e-9):
            if t[j + offset] is not None:
                if t[j + offset][1] == f:
                    # close face
                    o.append(t[j])
                    # tmp = t[j+offset]
                    # k = offset
                    # while k > 1:
                    #     t[j+k] = t[j+k-1]
                    #     k -= 1
                    # t[j+1] = tmp
                    # del t[j+offset]
                    # t.insert(j+1, tmp)
                    o.append(t[j + offset])
                    print(f)
                    print(t[j + offset][1])
                    if offset == 1:
                        j += 1
                    else:
                        t[j + offset] = None
                    break
                dn = t[j + offset][0]
                real_offset += 1
            offset += 1
        else:
            if real_offset > 1:
                # If real offset == 1, the ray
                # might have been terminated and this is the last triangle
                has_error = True
                print(f"error here ro:{real_offset}")
        j += 1
    if has_error:
        raise RuntimeError("Error on the ray")
    print(len(t))
    print(len(o))
